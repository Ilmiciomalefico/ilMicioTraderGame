<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ilMicioTrader - OpenSource Excellence</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-green: #39ff14;
            --neon-red: #ff003c;
            --neon-gold: #ffcc00;
            --bg-dark: #050505;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0; background: var(--bg-dark);
            color: white; font-family: 'Rajdhani', sans-serif;
            overflow: hidden; height: 100vh;
        }

        /* Cyberpunk UI */
        #ui-header {
            position: absolute; top: 20px; width: 94%; left: 3%;
            display: flex; justify-content: space-between; z-index: 100;
        }
        .stats-container {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px; border-left: 4px solid var(--neon-blue);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        #rank-title { font-family: 'Orbitron', sans-serif; font-size: 0.7em; letter-spacing: 2px; color: var(--neon-blue); }
        #xp-counter { font-size: 1.8em; font-weight: 900; }

        /* Micio Center Stage */
        #world {
            position: relative; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: radial-gradient(circle at center, #111 0%, #000 100%);
        }
        #micio-wrapper { position: relative; z-index: 10; transition: transform 0.1s; }
        #micio-sprite {
            font-size: 120px; filter: drop-shadow(0 0 20px rgba(255,255,255,0.3));
            animation: float 3s infinite ease-in-out;
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

        /* Dynamic Aura */
        .aura-core {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 250px; height: 250px; border-radius: 50%;
            filter: blur(50px); opacity: 0.3; z-index: 1;
            transition: background 0.5s;
        }

        /* Graphics Canvas */
        #chart-canvas { position: absolute; inset: 0; z-index: 5; }

        /* Interaction HUD */
        #hud {
            position: absolute; bottom: 40px; text-align: center; z-index: 100;
            width: 100%; pointer-events: none;
        }
        .status-pill {
            background: rgba(0,0,0,0.8); border: 1px solid var(--neon-blue);
            padding: 8px 25px; border-radius: 20px;
            font-family: 'Orbitron', sans-serif; font-size: 0.8em;
            box-shadow: 0 0 10px var(--neon-blue);
        }

        /* Glitch Effect */
        .glitch { animation: glitch-anim 0.2s infinite; }
        @keyframes glitch-anim {
            0% { transform: translate(0); }
            20% { transform: translate(-5px, 5px); }
            40% { transform: translate(-5px, -5px); }
            60% { transform: translate(5px, 5px); }
            80% { transform: translate(5px, -5px); }
            100% { transform: translate(0); }
        }

        #start-overlay {
            position: fixed; inset: 0; background: black; z-index: 1000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .btn-start {
            background: transparent; border: 2px solid var(--neon-green);
            color: var(--neon-green); padding: 20px 60px; font-family: 'Orbitron', sans-serif;
            font-weight: bold; cursor: pointer; transition: 0.3s;
            box-shadow: 0 0 20px rgba(57, 255, 20, 0.2);
        }
        .btn-start:hover { background: var(--neon-green); color: black; box-shadow: 0 0 40px var(--neon-green); }
    </style>
</head>
<body>

    <div id="start-overlay">
        <div style="font-size: 100px; margin-bottom: 20px;">üéÆ</div>
        <h1 style="font-family: 'Orbitron'; color: var(--neon-blue); letter-spacing: 5px;">IL MICIO TRADER</h1>
        <p style="letter-spacing: 2px; margin-bottom: 40px;">BITGET REAL-TIME ENGINE</p>
        <button class="btn-start" onclick="initGame()">INITIALIZE SYSTEM</button>
    </div>

    <div id="ui-header">
        <div class="stats-container">
            <div id="rank-title">SYSTEM RANK: CHUNKY</div>
            <div id="xp-counter">XP 0000</div>
        </div>
        <div class="stats-container" style="border-left: none; border-right: 4px solid var(--neon-blue); text-align: right;">
            <div id="live-price" style="color: var(--neon-blue); font-family: 'Orbitron'; font-size: 0.9em;">BTC/USDT CONNECTING...</div>
            <div id="pnl-pct" style="font-size: 1.8em; font-weight: 900;">+0.00%</div>
        </div>
    </div>

    <div id="world">
        <div id="aura" class="aura-core" style="background: var(--neon-blue);"></div>
        <div id="micio-wrapper">
            <div id="micio-sprite">üê±</div>
        </div>
        <canvas id="chart-canvas"></canvas>
    </div>

    <div id="hud">
        <div class="status-pill" id="action-hint">HOLD FOR LONG POSITION</div>
    </div>

    <script>
        let state = { xp: 0, price: 0, entry: 0, pos: 'SHORT', history: [], pnl: 0, rank: 'CHUNKY' };
        const canvas = document.getElementById('chart-canvas');
        const ctx = canvas.getContext('2d');
        const micio = document.getElementById('micio-sprite');
        const aura = document.getElementById('aura');

        function initGame() {
            document.getElementById('start-overlay').style.display = 'none';
            connectWS();
            window.onresize = resize; resize();
            requestAnimationFrame(renderLoop);
        }

        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }

        function connectWS() {
            const ws = new WebSocket('wss://ws.bitget.com/v2/ws/public');
            ws.onopen = () => ws.send(JSON.stringify({"op":"subscribe","args":[{"instType":"sp","channel":"ticker","instId":"BTCUSDT"}]}));
            ws.onmessage = (e) => {
                const d = JSON.parse(e.data);
                if (d.data && d.data[0]) {
                    state.price = parseFloat(d.data[0].lastPr);
                    state.history.push(state.price);
                    if(state.history.length > 100) state.history.shift();
                    if(state.entry === 0) state.entry = state.price;
                    updateLogic();
                }
            };
            ws.onclose = () => setTimeout(connectWS, 1000);
        }

        function updateLogic() {
            let diff = state.pos === 'LONG' ? (state.price - state.entry) : (state.entry - state.price);
            state.pnl = (diff / state.entry) * 100 * 40; // High stakes: 40x leverage
            
            if(state.pnl > 0) state.xp += 0.33;
            if(state.pnl <= -100) { 
                state.xp = Math.max(0, state.xp - 100); 
                state.entry = state.price;
                triggerGlitch();
            }

            // Update UI
            document.getElementById('live-price').innerText = `BTC: $${state.price.toLocaleString()}`;
            const pnlEl = document.getElementById('pnl-pct');
            pnlEl.innerText = `${state.pnl >= 0 ? '+' : ''}${state.pnl.toFixed(2)}%`;
            pnlEl.style.color = state.pnl >= 0 ? 'var(--neon-green)' : 'var(--neon-red)';
            document.getElementById('xp-counter').innerText = `XP ${Math.floor(state.xp).toString().padStart(4, '0')}`;
            
            evolveMicio();
        }

        function evolveMicio() {
            if(state.xp > 1000) {
                micio.innerText = "üëë"; aura.style.background = "var(--neon-gold)";
                document.getElementById('rank-title').innerText = "SYSTEM RANK: GIGA GOD";
                document.getElementById('rank-title').style.color = "var(--neon-gold)";
            } else if(state.xp > 300) {
                micio.innerText = "üï∂Ô∏è"; aura.style.background = "var(--neon-blue)";
                document.getElementById('rank-title').innerText = "SYSTEM RANK: ULTRA";
            }
        }

        function triggerGlitch() {
            document.body.classList.add('glitch');
            setTimeout(() => document.body.classList.remove('glitch'), 500);
        }

        // Inputs
        const inputStart = () => { state.pos = 'LONG'; state.entry = state.price; document.getElementById('action-hint').innerText = "LONG POSITION ACTIVE"; document.getElementById('action-hint').style.color = "var(--neon-green)"; };
        const inputEnd = () => { state.pos = 'SHORT'; state.entry = state.price; document.getElementById('action-hint').innerText = "SHORT POSITION ACTIVE"; document.getElementById('action-hint').style.color = "var(--neon-red)"; };

        window.onmousedown = inputStart; window.onmouseup = inputEnd;
        window.ontouchstart = (e) => { e.preventDefault(); inputStart(); };
        window.ontouchend = (e) => { e.preventDefault(); inputEnd(); };

        function renderLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if(state.history.length > 2) {
                // Glow effect for the line
                ctx.shadowBlur = 15;
                ctx.shadowColor = state.pnl >= 0 ? 'var(--neon-green)' : 'var(--neon-blue)';
                ctx.beginPath();
                ctx.lineWidth = 4;
                ctx.strokeStyle = state.pnl >= 0 ? 'var(--neon-green)' : 'var(--neon-blue)';
                
                let min = Math.min(...state.history);
                let max = Math.max(...state.history);
                let range = max - min || 1;

                state.history.forEach((p, i) => {
                    let x = i * (canvas.width / 100);
                    let y = canvas.height - ((p - min) / range * (canvas.height * 0.6) + (canvas.height * 0.2));
                    if(i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
                });
                ctx.stroke();
                ctx.shadowBlur = 0;
            }
            // Parallax effect on Micio
            document.getElementById('micio-wrapper').style.transform = `scale(${1 + state.pnl/500}) translateY(${Math.sin(Date.now()/500)*10}px)`;
            
            requestAnimationFrame(renderLoop);
        }
    </script>
</body>
</html>
